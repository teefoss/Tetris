//
//  tetraminos.c
//  Tetron
//
//  Created by Thomas Foster on 8/15/18.
//

#include <stdio.h>
#include <string.h>
#include "tetramino.h"

char shapes[TET_COUNT][R_COUNT][DATA_SIZE][DATA_SIZE] =
{
	{ // O
		{ {1,1,0,0},{1,1,0,0},{0,0,0,0},{0,0,0,0}, },
		{ {1,1,0,0},{1,1,0,0},{0,0,0,0},{0,0,0,0}, },
		{ {1,1,0,0},{1,1,0,0},{0,0,0,0},{0,0,0,0}, },
		{ {1,1,0,0},{1,1,0,0},{0,0,0,0},{0,0,0,0}, },
	},
	{ // I
		{ {0,0,0,0},{2,2,2,2},{0,0,0,0},{0,0,0,0}, },
		{ {0,0,2,0},{0,0,2,0},{0,0,2,0},{0,0,2,0}, },
		{ {0,0,0,0},{2,2,2,2},{0,0,0,0},{0,0,0,0}, },
		{ {0,0,2,0},{0,0,2,0},{0,0,2,0},{0,0,2,0}, },
	},
	{ // L
		{ {0,0,0,0},{3,3,3,0},{3,0,0,0},{0,0,0,0}, },
		{ {0,3,0,0},{0,3,0,0},{0,3,3,0},{0,0,0,0}, },
		{ {0,0,0,0},{0,0,3,0},{3,3,3,0},{0,0,0,0}, },
		{ {3,3,0,0},{0,3,0,0},{0,3,0,0},{0,0,0,0}, },
	},
	{ // J
		{ {0,0,0,0},{4,4,4,0},{0,0,4,0},{0,0,0,0}, },
		{ {0,4,4,0},{0,4,0,0},{0,4,0,0},{0,0,0,0}, },
		{ {0,0,0,0},{4,0,0,0},{4,4,4,0},{0,0,0,0}, },
		{ {0,4,0,0},{0,4,0,0},{4,4,0,0},{0,0,0,0}, },
	},
	{ // S
		{ {0,0,0,0},{0,5,5,0},{5,5,0,0},{0,0,0,0}, },
		{ {0,5,0,0},{0,5,5,0},{0,0,5,0},{0,0,0,0}, },
		{ {0,0,0,0},{0,5,5,0},{5,5,0,0},{0,0,0,0}, },
		{ {0,5,0,0},{0,5,5,0},{0,0,5,0},{0,0,0,0}, },
	},
	{ // Z
		{ {0,0,0,0},{6,6,0,0},{0,6,6,0},{0,0,0,0}, },
		{ {0,0,6,0},{0,6,6,0},{0,6,0,0},{0,0,0,0}, },
		{ {0,0,0,0},{6,6,0,0},{0,6,6,0},{0,0,0,0}, },
		{ {0,0,6,0},{0,6,6,0},{0,6,0,0},{0,0,0,0}, },
	},
	{ // T
		{ {0,0,0,0},{7,7,7,0},{0,7,0,0},{0,0,0,0}, },
		{ {0,7,0,0},{0,7,7,0},{0,7,0,0},{0,0,0,0}, },
		{ {0,0,0,0},{0,7,0,0},{7,7,7,0},{0,0,0,0}, },
		{ {0,7,0,0},{7,7,0,0},{0,7,0,0},{0,0,0,0}, },
	},
};

char displayshapes[TET_COUNT][DATA_SIZE][DATA_SIZE] =
{
	{
		{0,1,1,0},
		{0,1,1,0},
		{0,0,0,0},
		{0,0,0,0}
	}, {
		{1,1,1,1},
		{0,0,0,0},
		{0,0,0,0},
		{0,0,0,0},
	}, {
		{0,1,1,1},
		{0,1,0,0},
		{0,0,0,0},
		{0,0,0,0},
	}, {
		{0,1,1,1},
		{0,0,0,1},
		{0,0,0,0},
		{0,0,0,0},
	}, {
		{0,0,1,1},
		{0,1,1,0},
		{0,0,0,0},
		{0,0,0,0},
	}, {
		{0,1,1,0},
		{0,0,1,1},
		{0,0,0,0},
		{0,0,0,0},
	}, {
		{0,1,1,1},
		{0,0,1,0},
		{0,0,0,0},
		{0,0,0,0},
	},
};

char guidedata[TET_COUNT][R_COUNT][4];

// create the look-up table for drop guide positions
void InitDropGuides (void)
{
    int t, r, x, y;
    
    memset(guidedata, -1, sizeof(guidedata));
    
    for (t=0 ; t<TET_COUNT ; t++) {
        for (r=0 ; r<R_COUNT ; r++)
        {
            for (x=0 ; x<DATA_SIZE ; x++) {
                for (y=0 ; y<DATA_SIZE; y++)
                {
                    if (shapes[t][r][y][x]) {
                        guidedata[t][r][x] = y;
                    }
                }
            }
        }
    }
}
